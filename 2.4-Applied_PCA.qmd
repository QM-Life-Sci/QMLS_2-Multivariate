---
title: "Applied PCA"
subtitle: "An incomplete tour of example use cases"
author:
  - Elizabeth King
  - Kevin Middleton
format:
  revealjs:
    theme: [default, custom.scss]
    standalone: true
    self-contained: true
    logo: QMLS_Logo.png
    slide-number: true
    show-slide-number: all
---

## Applications of PCA 


```{r}
#| label: setup
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(cowplot)

ggplot2::theme_set(theme_cowplot())
```

PCA (and other eigen-like analyses) is one of the most useful tools in data science

- Create a new holistic variable 
- Reduce dimensionality
- A way to quantify and describe shared variance
- Separates shared variation into independent sets

## PCA as a way to identify important confounding variables

Batch effects

- Often (but not always) not of interest
- Due to non-independence of sets of samples
- Failure to account for these 
    - at best: lowers power
    - at worst: leads to incorrect conclusions
      
> The signature of batch effects is shared variance

## Known and Unknown Batches

Example dataset:

- Activity levels of growth factor receptor network (GFRN) pathways in relation to breast cancer progression
- Treatment: specific GFRN oncogenes were induced by transfection 
- Controls were transfected with a vector that expresses a green fluorescent protein (GFP)
- Experiment was done in 3 batches. 

## Known and Unknown Batches

`~ Gene1 + Gene2 + Gene3 ....... Gene17000`

![](./Images/combat_uncor.png){fig-align="center" width=40%}

## Known and Unknown Batches in RNA-seq

![](./Images/combat.png){fig-align="center" width=100%}

## Population Structure

Example dataset:

- Genome sequencing at ~2.8 million SNPs
- 17 tigers from regions in India

## Population Structure

`~ SNP1 + SNP2 + SNP3 ....... SNP2800000`

![](./Images/tiger_popst.png){fig-align="center" width=60%}

## Creating a useful composite for analysis

Example dataset:

- Cultivars of *Brassica oleracea* planted in a common garden
- Measured herbivore species presence and abundance
- Measured glucosinolate concentrations (10 chemicals)

## Glucosinolate composite

`~ Glu1 + Glu2....Glu10`

- PC1 explained 72% of the variance
- increasing scores on PC1 = increase in glucoiberin and decrease in glucoraphanin

## Glucosinolate composite

![](./Images/gluc1_pca.png){fig-align="center" width=50%}

## Herbivore composite

![](./Images/gluc2.png){fig-align="center" width=80%}

Dworkin paper

